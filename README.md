# 台股管理系統

一個基於 Python 和 Tkinter 的台股技術分析工具，支援股票資料管理、分類管理和技術面圖表分析。

## 功能特色

### 📊 大盤與股票管理
- **查看大盤**：即時查看台股加權指數走勢（^TWII）
- **新增股票**：輸入股票代號（如 2330）自動抓取歷史資料
- **分類管理**：支援多重分類標籤，方便整理不同類型股票
- **批次更新**：一鍵更新所有股票的最新價格資料
- **刪除股票**：移除不需要的股票資料

### 📈 技術分析
- **股價走勢圖**：
  - 收盤價線圖
  - MA20、MA60 移動平均線
  - 自訂時間範圍（1個月、3個月、6個月、1年、全部）
  
- **漲跌幅分析**：
  - 每日漲跌幅柱狀圖
  - 平均漲跌幅統計
  - 紅漲綠跌視覺化

- **成交量分析**：
  - 成交量柱狀圖（紅漲綠跌）
  - 20日均量趨勢線

### 🏷️ 分類系統
- **全部股票**：查看所有已新增的股票
- **自訂分類**：新增/刪除自訂分類
- **多重標籤**：一支股票可屬於多個分類
- **分類瀏覽**：依分類快速篩選股票

## 安裝方式

### 系統需求
- Python 3.7 或以上版本
- 網路連線（用於下載股價資料）

### 安裝步驟

1. **安裝必要套件**
```bash
pip install yfinance pandas matplotlib
```

2. **下載程式檔案**
```
taiwan_stock/
├── main.py           # 主程式（UI 介面）
├── download_data.py  # 資料下載模組
├── database.py       # 資料庫管理模組
└── database/         # 資料庫檔案目錄（自動建立）
```

3. **執行程式**
```bash
python main.py
```

## 使用說明

### 查看大盤

1. 點選主畫面的「查看大盤」
2. 系統自動載入台股加權指數（^TWII）的歷史資料
3. 可切換不同圖表類型：
   - **指數走勢**：加權指數走勢圖 + MA20、MA60
   - **漲跌幅**：每日漲跌幅柱狀圖
   - **成交量**：大盤成交量分析
4. 可調整時間範圍（1個月 / 3個月 / 6個月 / 1年 / 全部）

### 新增股票

1. 點選主畫面的「新增股票」
2. 輸入股票代號（僅需輸入數字，如 `2330`）
3. 選擇要歸類的分類（可多選）
4. 點選「新增」按鈕
5. 系統會自動嘗試 `.TW`（上市）和 `.TWO`（上櫃）兩種格式
6. 成功後會顯示完整代號（如 `2330.TW` 或 `5274.TWO`）

**支援格式**：
- 僅輸入代號：`2330` → 系統自動嘗試 `2330.TW` 和 `2330.TWO`
- 手動指定上市：`2330.TW`
- 手動指定上櫃：`5274.TWO`

**自動判斷機制**：
系統會先嘗試 `.TW`（上市），如果查無資料則自動嘗試 `.TWO`（上櫃），讓您無需記憶股票是上市還是上櫃。

### 瀏覽股票

1. 點選「瀏覽股票」
2. 選擇分類或「全部股票」
3. 在股票列表中可進行以下操作：
   - **技術分析**：查看股價走勢、漲跌幅、成交量
   - **編輯分類**：修改該股票的分類標籤
   - **刪除**：移除股票資料

### 技術分析

在技術分析頁面中，可以：
- **切換圖表類型**：股價走勢 / 漲跌幅 / 成交量
- **調整時間範圍**：1個月 / 3個月 / 6個月 / 1年 / 全部
- **時間軸導航**：前後移動查看歷史資料

### 管理分類

1. 點選「管理分類」
2. 可以新增自訂分類
3. 可以刪除不需要的分類（不會刪除股票本身）

### 更新股價

點選「更新所有股價」會：
- 自動檢查每支股票的最後更新日期
- 只下載新的資料（節省時間）
- 顯示更新進度和統計

## 資料來源

本程式使用 **Yahoo Finance** 作為資料來源，透過 `yfinance` 套件取得：
- 歷史股價（開盤、最高、最低、收盤）
- 成交量
- 股息和股票分割資訊

## 資料庫結構

使用 SQLite 資料庫，包含三個主要表格：

1. **price_daily**：股價日線資料
   - date, open, high, low, close, volume, dividends, stock_splits, ticker

2. **categories**：分類資料
   - id, name

3. **ticker_categories**：股票與分類的對應關係
   - ticker, category_id

## 常見問題

### Q: 為什麼有些股票無法新增？
A: 可能原因：
- 股票代碼輸入錯誤
- 該股票不在 Yahoo Finance 的資料庫中（某些興櫃股票可能無資料）
- 系統會自動嘗試 `.TW` 和 `.TWO`，如果都失敗則代表該股票無法從 Yahoo Finance 取得資料

### Q: 如何知道股票是上市還是上櫃？
A: 不需要知道！系統會自動嘗試兩種格式。您只需輸入代號（如 `2330`），系統會自動找到正確的格式。

### Q: 如何更新股價資料？
A: 點選主畫面的「更新所有股價」按鈕，系統會自動更新所有股票。

### Q: 刪除分類會刪除股票嗎？
A: 不會。刪除分類只會移除分類標籤，股票資料仍會保留。

### Q: 可以同時開啟多個視窗嗎？
A: 不建議。請使用「返回」按鈕在不同頁面間切換。

## 技術細節

### 移動平均線計算
- MA20：20日移動平均
- MA60：60日移動平均

### 漲跌幅計算
- 每日漲跌幅 = (當日收盤價 - 前日收盤價) / 前日收盤價 × 100%

### 資料更新機制
- 首次新增：下載所有歷史資料
- 後續更新：只下載最後更新日期之後的資料

## 注意事項

1. **資料準確性**：資料來自 Yahoo Finance，可能有延遲或誤差
2. **網路需求**：下載和更新資料需要網路連線
3. **僅供參考**：本程式僅供學習和參考，不構成投資建議
4. **資料備份**：`database/taiwan_stock.db` 檔案包含所有資料，建議定期備份

## 授權說明

本程式僅供個人學習和研究使用。使用本程式所做的任何投資決策，風險自負。

## 更新日誌

### v1.0 (2026-02-04)
- 初始版本發布
- 支援台股技術分析
- 分類管理功能
- 批次更新功能

---

**開發環境**：Python 3.7+, Tkinter, yfinance, pandas, matplotlib
